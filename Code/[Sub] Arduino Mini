//사용자 착석 코드
#define FSRCount 4 //센서 수
#define BELTPIN 12 //벨트 핀 번호
int FSRsensors[FSRCount] = {A0,A1,A2,A3};
int values[FSRCount] = {0,0,0,0};
bool sit[FSRCount] = {false,false,false,false}; // 없어도 될 수도..
bool state = false;

//bool checkBelt();

void setup() {
  // put your setup code here, to run once:
  Serial.begin(9600);
  pinMode(BELTPIN,INPUT);
  while(state == isSit());
  Serial.print("Sit in setup");
}

void loop() {
  // put your main code here, to run repeatedly:
  state = isSit();
  Serial.print("is Sit? ::::: ");
  Serial.println(state);
  if(digitalRead(BELTPIN) == HIGH){
    Serial.println("button on");
  }
}

//4개의 압력 센서 값 읽기
void getFSR(){
  int i=0;
  for(i= 0;i<FSRCount;i++){
  	values[i] = analogRead(FSRsensors[i]);
  	Serial.print("FSR");
    Serial.print(i);
    Serial.print(" : ");
  	Serial.println(values[i]);
  }
  delay(1000);
  return;
}


//앉았는지 확인.. 4개의 값 모두 400 초과이면 true
bool isSit(){
  int i;
  if(checkBelt() == false){
    return false;
  }
  getFSR();
  for(i=0;i<FSRCount;i++){
    if(values[i] > 400){
      sit[i] = true;
    }
    else{
      sit[i] = false;
    }
  }
  for(i=0;i<FSRCount;i++){
    if(sit[i]==false){
      return false;
    }
  }
  return true;
}

//안전벨트 확인
bool checkBelt(){
  if(digitalRead(BELTPIN)==HIGH){
    Serial.print("Button on");
    return true;
  }
  else{
    return false;
  }
}







-------------------------------------------------------------------------------
gps 센서 감지 및 위도 경도 추출 함수 코드(부품과 코드 호환 테스트 진행 X)
방법 1 (라이브러리 이용)
#include <SoftwareSerial.h>
SoftwareSerial gps(11,12);

gps.begin(9600);

while (ss.available() > 0){
  gps.encode(ss.read());
  if (gps.location.isUpdated()){
    Serial.print("Latitude= "); 
    Serial.print(gps.location.lat(), 6);
    Serial.print(" Longitude= "); 
    Serial.println(gps.location.lng(), 6)
  }
}


방법 2 (계산식을 이용한 1차 적인 방법)
#include <SoftwareSerial.h>
// tx 10 rx 11
SoftwareSerial gpsSerial(10,11);

char c ="";
String str ="";
String targetStr = "GPGGA";

gpsSerial.begin(9600);
  if(gpsSerial.available()){
    c=gpsSerial.read(); // 센서값 읽기
    if(c=='\n'){
      if(targetStr.equals(str.substring(1,6))){
        //NMEA의 GPGGA 같을 때
        Serial.println(str);
        int one = str.indexOf(",");
        int two = str.indexOf(",",one+1);
        int three = str.indexOf(",",two+1);
        int four = str.indexOf(",",three+1);
        int five = str.indexOf(",",four+1);

        String Lat = str.substring(two+1,three);
        String Long = str.substring(four+1,five);

        String Lat1 = Lat.substring(0,2);
        String Lat2 = Lat.substring(2);

        String Long1 = Long.substring(0,3);
        String Long2 = Long.substring(3);

        double LatF = Lat1.toDouble() + Lat2.toDouble()/60;
        double LongF = Long1.toFloat() + Long2.toFloat()/60;
      }
      str = ""; //초기화
    }
    else{
      str +=c;
    }
  }
